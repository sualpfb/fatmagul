<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8" />
    <title>Harita Tahmin Oyunu</title>
    <link rel="stylesheet" href="static/styles.css" />
    <style>
        #dunyaHaritasi {
            max-width: 100%;
            height: 400px;
            margin: 20px auto;
            border: 2px solid white;
            border-radius: 10px;
            cursor: crosshair;
        }
        #puan {
            font-size: 18px;
            margin-top: 15px;
            font-weight: bold;
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>ğŸŒ Haritada Yer Tahmin Oyunu</h2>
        <p>Google Haritalar'da rastgele bir yere atÄ±ldÄ±n. Åimdi dÃ¼nya haritamÄ±zda tahmin et ve puanÄ±nÄ± kazan!</p>

        <button id="google-harita-btn" class="big-button"
          onclick="window.open('https://www.google.com/maps?q=' + window.hedefKoordinat[0] + ',' + window.hedefKoordinat[1], '_blank')"
        >Google Haritalar'da Konumu GÃ¶ster</button>

        <img
            src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/80/World_map_-_low_resolution.svg/1024px-World_map_-_low_resolution.svg.png"
            alt="DÃ¼nya HaritasÄ±"
            id="dunyaHaritasi"
        />

        <div id="puan">PuanÄ±nÄ±z: 0</div>
        <button id="yeniOyunBtn" class="big-button">Yeni Oyun BaÅŸlat</button>
    </div>

    <script>
        // Rastgele koordinat Ã¼ret (dÃ¼nya sÄ±nÄ±rlarÄ± iÃ§inde)
        function rastgeleKoordinat() {
            const lat = (Math.random() * 180) - 90; // -90 ile 90 arasÄ±
            const lng = (Math.random() * 360) - 180; // -180 ile 180 arasÄ±
            return [lat, lng];
        }

        // Hedef koordinatÄ± global yaptÄ±k ki butondan eriÅŸilsin
        window.hedefKoordinat = rastgeleKoordinat();

        const haritaImg = document.getElementById("dunyaHaritasi");
        const puanDiv = document.getElementById("puan");
        const yeniOyunBtn = document.getElementById("yeniOyunBtn");

        let puan = 0;

        function dereceToPixel(lat, lng) {
            // Harita img iÃ§in basit dÃ¶nÃ¼ÅŸÃ¼m:
            // Enlem 90 (Ã¼st) - -90 (alt)
            // Boylam -180 (sol) - 180 (saÄŸ)

            // resmin geniÅŸlik ve yÃ¼ksekliÄŸi:
            const genislik = haritaImg.width;
            const yukseklik = haritaImg.height;

            // X ekseni iÃ§in: boylam -180...180 => 0...genislik
            const x = ((lng + 180) / 360) * genislik;

            // Y ekseni iÃ§in: enlem 90...-90 => 0...yukseklik (ters)
            const y = ((90 - lat) / 180) * yukseklik;

            return { x, y };
        }

        function hesaplaUzaklik(p1, p2) {
            // Basit Ã–klid uzaklÄ±ÄŸÄ± (px cinsinden)
            const dx = p1.x - p2.x;
            const dy = p1.y - p2.y;
            return Math.sqrt(dx * dx + dy * dy);
        }

        haritaImg.addEventListener("click", function (event) {
            // KullanÄ±cÄ±nÄ±n tÄ±kladÄ±ÄŸÄ± koordinatÄ± hesapla
            const rect = haritaImg.getBoundingClientRect();
            const clickX = event.clientX - rect.left;
            const clickY = event.clientY - rect.top;

            // Hedef koordinatÄ±nÄ± pixel cinsine Ã§evir
            const hedefPixel = dereceToPixel(window.hedefKoordinat[0], window.hedefKoordinat[1]);
            const tahminPixel = { x: clickX, y: clickY };

            const uzaklik = hesaplaUzaklik(hedefPixel, tahminPixel);

            // UzaklÄ±k arttÄ±kÃ§a puan azalÄ±r, Ã¶rn max 100 puan, 0 puan iÃ§in 200px Ã¼zeri uzaklÄ±k
            let kazanilanPuan = Math.max(0, Math.round(100 - (uzaklik / 2)));

            puan += kazanilanPuan;

            puanDiv.textContent = `PuanÄ±nÄ±z: ${puan} (Bu tahmin: ${kazanilanPuan} puan)`;

            alert(`Tahmininiz ile gerÃ§ek konum arasÄ± uzaklÄ±k: ${Math.round(uzaklik)} piksel.\nBu tahmin iÃ§in ${kazanilanPuan} puan kazandÄ±nÄ±z.`);
        });

        yeniOyunBtn.addEventListener("click", function () {
            window.hedefKoordinat = rastgeleKoordinat();
            puan = 0;
            puanDiv.textContent = "PuanÄ±nÄ±z: 0";
            alert("Yeni oyun baÅŸladÄ±! Google Haritalar'da yeni konumu gÃ¶rmek iÃ§in butona tÄ±kla.");
        });
    </script>
</body>
</html>
